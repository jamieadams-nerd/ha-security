Understood — we’ll stay tightly scoped to **handling-restriction deltas** relative to your established **CUI-BASE** model, expressed in JSON-ready form.

I’ll treat this exactly how you’re modeling the catalog:

* Base handling = already inherited
* AGR adds **sector-specific dissemination / safety overlays**
* Subcategories add **hazard / misuse / infrastructure sensitivity controls**

No NIST mapping yet, no lifecycle expansion — just handling caveats.

---

# 1) AGR — Category-Level Handling Additions

Agriculture CUI generally introduces restrictions tied to:

* Food supply integrity
* Biosecurity / agroterrorism risk
* Critical infrastructure sensitivity
* Economic impact disclosures

### AGR Handling Delta (JSON model)

```json
{
  "category": "AGR",
  "handling_restrictions": [
    {
      "code": "AGR-INFRA",
      "display": "Agricultural Infrastructure Sensitive",
      "description": "Information revealing vulnerabilities in agricultural production, storage, or distribution systems.",
      "enforcement": {
        "dissemination_limit": "authorized_agriculture_personnel",
        "public_release": false,
        "critical_infrastructure": true
      }
    },
    {
      "code": "FOOD-SUPPLY",
      "display": "Food Supply Sensitive",
      "description": "Information impacting food supply safety, contamination response, or continuity planning.",
      "enforcement": {
        "public_health_coordination_required": true,
        "distribution_restriction": "need_to_know",
        "export_control_review": true
      }
    },
    {
      "code": "AGRO-BIOSEC",
      "display": "Agro Biosecurity",
      "description": "Information that could enable intentional harm to crops, livestock, or food systems.",
      "enforcement": {
        "misuse_risk": true,
        "foreign_dissemination_review": true,
        "research_release_review": true
      }
    }
  ]
}
```

These sit **in addition to CUI-BASE** (e.g., NOFORN if applied, FEDCON, etc.).

---

# 2) AGR/AMNT — Ammonium Nitrate

This is one of the most sensitive AGR subdomains due to dual-use explosive potential.

Handling overlays focus on:

* Theft/diversion risk
* Storage security
* Facility targeting risk
* Precursor weaponization

### AMNT Handling Delta

```json
{
  "subcategory": "AMNT",
  "parent": "AGR",
  "handling_restrictions": [
    {
      "code": "EXP-PRECURSOR",
      "display": "Explosive Precursor Sensitive",
      "description": "Information involving materials that may be used to manufacture explosives.",
      "enforcement": {
        "distribution_restriction": "licensed_personnel_only",
        "facility_disclosure_limit": true,
        "aggregation_risk": true
      }
    },
    {
      "code": "STORAGE-SEC",
      "display": "Hazardous Storage Security",
      "description": "Details regarding storage quantities, configurations, or vulnerabilities.",
      "enforcement": {
        "site_specific_redaction": true,
        "physical_security_sensitive": true,
        "public_release": false
      }
    },
    {
      "code": "DIVERSION-RISK",
      "display": "Material Diversion Risk",
      "description": "Supply chain or transport information that could enable theft or diversion.",
      "enforcement": {
        "transport_route_protection": true,
        "vendor_identity_limit": true,
        "law_enforcement_coordination": true
      }
    }
  ]
}
```

---

# 3) AGR/CHEM — Agricultural Chemicals

Broader than ammonium nitrate — includes fertilizers, soil treatments, industrial ag compounds.

Risk domains:

* Environmental contamination misuse
* Bulk chemical weaponization
* Trade / formulation IP
* Infrastructure targeting

### CHEM Handling Delta

```json
{
  "subcategory": "CHEM",
  "parent": "AGR",
  "handling_restrictions": [
    {
      "code": "AG-CHEM-SENS",
      "display": "Agricultural Chemical Sensitive",
      "description": "Technical or operational details regarding agricultural chemical composition or use.",
      "enforcement": {
        "formula_protection": true,
        "bulk_handling_restriction": true,
        "industrial_use_only": true
      }
    },
    {
      "code": "ENV-CONTAM",
      "display": "Environmental Contamination Risk",
      "description": "Information that could enable large-scale environmental or crop contamination.",
      "enforcement": {
        "misuse_risk": true,
        "application_method_limit": true,
        "public_release": false
      }
    },
    {
      "code": "SUPPLY-CHAIN",
      "display": "Chemical Supply Chain Sensitive",
      "description": "Vendor, transport, or storage ecosystem details.",
      "enforcement": {
        "vendor_redaction": true,
        "logistics_obfuscation": true
      }
    }
  ]
}
```

---

# 4) AGR/PCI — Pesticides

Here the risk shifts slightly:

* Toxicity misuse
* Food contamination
* Public health exposure
* Regulatory enforcement sensitivity

### PCI Handling Delta

```json
{
  "subcategory": "PCI",
  "parent": "AGR",
  "handling_restrictions": [
    {
      "code": "TOXIC-USE",
      "display": "Toxic Application Sensitive",
      "description": "Information on pesticide toxicity, concentration, or lethality thresholds.",
      "enforcement": {
        "misuse_risk": true,
        "public_health_sensitive": true,
        "distribution_restriction": "certified_applicators"
      }
    },
    {
      "code": "FOOD-CONTAM",
      "display": "Food Contamination Risk",
      "description": "Information that could enable intentional contamination of food sources.",
      "enforcement": {
        "supply_chain_protection": true,
        "facility_identity_limit": true,
        "recall_coordination_required": true
      }
    },
    {
      "code": "REG-ENF",
      "display": "Regulatory Enforcement Sensitive",
      "description": "Inspection findings, violations, or enforcement targeting data.",
      "enforcement": {
        "premature_disclosure_prohibited": true,
        "investigative_hold": true
      }
    }
  ]
}
```

---

# 5) Structural Integration Pattern

How this composes in your catalog hierarchy:

```json
{
  "cui_categories": [
    {
      "code": "AGR",
      "inherits": "CUI-BASE",
      "handling_restrictions": [ "...AGR-level..." ],
      "subcategories": [
        {
          "code": "AMNT",
          "handling_restrictions": [ "...AMNT..." ]
        },
        {
          "code": "CHEM",
          "handling_restrictions": [ "...CHEM..." ]
        },
        {
          "code": "PCI",
          "handling_restrictions": [ "...PCI..." ]
        }
      ]
    }
  ]
}
```

Inheritance model you’re testing:

```
CUI-BASE
   ↓
AGR
   ↓
AMNT / CHEM / PCI
```

Handling caveats accumulate unless explicitly overridden.

---

# 6) Design Observations (for your model validation)

Key differences across the three:

| Subcat | Primary Risk Axis                 |
| ------ | --------------------------------- |
| AMNT   | Explosive precursor / diversion   |
| CHEM   | Industrial / environmental misuse |
| PCI    | Toxicity / food contamination     |

So enforcement engines could branch on:

* Physical security
* Transport secrecy
* Applicator certification
* Public health coordination

---

If you want next, we can:

* Add validation rules (required caveats per subcat)
* Map caveats → vault placement constraints
* Define XATTR encoding schema
* Build setrans display strings for caveats

Your call on the next layer.





Excellent — this is the right modeling question at the right time.

You’re essentially asking:

> “I already have restriction IDs in my handling catalog.
> This enforcement/risk object is rich — but it’s not policy text.
> How do I structurally bind them without corrupting the model?”

Let’s make the separation explicit, then show the join patterns.

---

# 1) Two Different Semantic Objects

You’re holding two artifacts that live at different assurance layers.

### A) Handling Restriction (what you already have)

Authoritative, regulatory, auditable.

```json
{
  "id": "AMNT-HND-001",
  "text": "Detailed storage locations, quantities, or facility layouts involving ammonium nitrate must be restricted.",
  "category": "physical_security"
}
```

This answers:

* What is restricted?
* Under what authority?
* How must it be handled?

It is **policy language**.

---

### B) Risk / Enforcement Descriptor (what you like)

Operational, analytic, automatable.

```json
{
  "code": "EXP-PRECURSOR",
  "display": "Explosive Precursor Sensitive",
  "description": "Information involving materials that may be used to manufacture explosives.",
  "enforcement": {
    "distribution_restriction": "licensed_personnel_only",
    "facility_disclosure_limit": true,
    "aggregation_risk": true
  }
}
```

This answers:

* Why is it restricted?
* What risk model applies?
* What system reactions should occur?

It is **risk semantics**.

---

# 2) The Key Insight

Handling restrictions are not risk objects.

They are **policy manifestations of risk**.

So the relationship is:

```text
Risk Domain → Drives → Handling Restrictions
```

Not the other way around.

---

# 3) Clean Marriage Pattern (Recommended)

You keep your restriction array intact.

You introduce a risk reference pointer.

### Step 1 — Define Risk Domains Catalog

Sidecar file or adjacent block:

```json
{
  "risk_domains": {
    "EXP-PRECURSOR": {
      "display": "Explosive Precursor Sensitive",
      "description": "Information involving materials that may be used to manufacture explosives.",
      "enforcement": {
        "distribution_restriction": "licensed_personnel_only",
        "facility_disclosure_limit": true,
        "aggregation_risk": true
      }
    }
  }
}
```

Think of this as a reusable ontology.

---

### Step 2 — Bind Restrictions to Risk

Add a reference inside your existing restriction object:

```json
{
  "id": "AMNT-HND-001",
  "text": "Detailed storage locations, quantities, or facility layouts involving ammonium nitrate must be restricted.",
  "category": "physical_security",
  "risk_domains": [
    "EXP-PRECURSOR"
  ],
  "nist_controls": []
}
```

No enforcement logic lives here — just linkage.

---

# 4) Runtime Join Model

At evaluation time your engine composes:

```text
Restriction
   ↓
Linked Risk Domain(s)
   ↓
Enforcement Semantics
```

So effective enforcement becomes:

```json
{
  "restriction_id": "AMNT-HND-001",
  "effective_enforcement": {
    "distribution_restriction": "licensed_personnel_only",
    "facility_disclosure_limit": true,
    "aggregation_risk": true
  }
}
```

Policy remains authoritative — risk drives automation.

---

# 5) Why This Is Architecturally Correct

Because multiple restrictions can share one risk domain.

Example:

| Restriction ID | Risk Domain   |
| -------------- | ------------- |
| AMNT-HND-001   | EXP-PRECURSOR |
| AMNT-HND-002   | EXP-PRECURSOR |
| CHEM-HND-003   | EXP-PRECURSOR |

You avoid duplicating enforcement metadata everywhere.

---

# 6) It Also Supports Multi-Risk Binding

Some restrictions arise from overlapping risks.

Example:

```json
{
  "id": "PCI-HND-002",
  "text": "Facility-specific pesticide storage data must not be publicly disclosed.",
  "risk_domains": [
    "TOXIC-USE",
    "FOOD-CONTAM"
  ]
}
```

Now enforcement aggregates both risk models.

---

# 7) How It Fits Your Existing Handling Groups

No structural change required.

You still have:

```text
handling_groups
   → restrictions[]
```

You simply enrich restrictions with semantic linkage:

```json
{
  "handling_groups": {
    "AGR-AMNT-GROUP": {
      "restrictions": [
        {
          "id": "AMNT-HND-001",
          "risk_domains": ["EXP-PRECURSOR"]
        }
      ]
    }
  }
}
```

Inheritance still works normally.

---

# 8) Optional Enhancement — Risk Weighting

Later, you could add analytic scoring:

```json
{
  "risk_domains": {
    "EXP-PRECURSOR": {
      "risk_score": 9,
      "aggregation_risk": true
    }
  }
}
```

Enables:

* Vault placement escalation
* Guard review thresholds
* Export denial automation

But that’s future layering.

---

# 9) Conceptual Model (Unified)

Here’s the final semantic stack:

```text
Risk Domain
   ↓ motivates
Handling Restriction
   ↓ governs
Data Custody & Dissemination
   ↓ enforced by
System Controls
```

So your example object becomes:

* Not a restriction
* Not a caveat
* A risk ontology node

Linked — not embedded.

---

# 10) Direct Answer to Your Question

How do you marry them?

You do **not** merge structures.

You relate them.

Minimal schema addition:

```json
restrictions[].risk_domains[]
```

Everything else stays intact.

---

If you want next, we can:

* Normalize a starter risk ontology for all CUI categories
* Build inheritance-aware risk aggregation
* Bind risk → vault placement tiers
* Bind risk → cross-domain release guards

Because once risk semantics exist, automation becomes dramatically more intelligent.


